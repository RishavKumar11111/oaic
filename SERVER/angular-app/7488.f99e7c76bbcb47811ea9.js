"use strict";(self.webpackChunkangular_application=self.webpackChunkangular_application||[]).push([[7488],{7488:(N,d,i)=>{i.r(d),i.d(d,{ApprovePaymentsModule:()=>I});var c=i(8583),v=i(6901),_=i(9779),Z=i(4762),t=i(639),m=i(4495),g=i(5620),u=i(9344),A=i(1879),l=i(665),T=i(231);function f(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",4),t.TgZ(1,"div",5),t.TgZ(2,"span"),t.TgZ(3,"strong"),t.TgZ(4,"label"),t._uU(5,"Approve Vendor Payments"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"div",6),t.TgZ(7,"div",7),t.TgZ(8,"div",8),t.TgZ(9,"app-financial-year",9),t.NdJ("newItemEvent",function(p){return t.CHM(e),t.oxw().changeFinancialYear(p)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}}function h(n,a){1&n&&t._UZ(0,"div",10)}function y(n,a){if(1&n&&(t.TgZ(0,"div",12),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" No record found on financial year ",e.fin_year,". ")}}function x(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td"),t.TgZ(14,"button",20),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(3).viewDetails(r)}),t._UZ(15,"i",21),t.qZA(),t.qZA(),t.TgZ(16,"td"),t.TgZ(17,"input",22),t.NdJ("ngModelChange",function(p){return t.CHM(e).$implicit.checkbox=p}),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=a.$implicit,o=a.index;t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(e.approval_id),t.xp6(2),t.Oqu(e.pp_id),t.xp6(2),t.Oqu(t.xi3(9,6,e.approval_date,"dd-MM-yyyy")),t.xp6(3),t.Oqu(t.lcZ(12,9,e.pay_now_amount)),t.xp6(6),t.Q6J("ngModel",e.checkbox)}}function q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",13),t.TgZ(2,"table",14),t._UZ(3,"caption"),t.TgZ(4,"thead"),t.TgZ(5,"tr"),t.TgZ(6,"th",15),t._uU(7,"SL."),t.qZA(),t.TgZ(8,"th",15),t._uU(9,"Approval ID"),t.qZA(),t.TgZ(10,"th",15),t._uU(11,"Part payment ID"),t.qZA(),t.TgZ(12,"th",15),t._uU(13,"Approval date"),t.qZA(),t.TgZ(14,"th",15),t._uU(15,"Amount"),t.qZA(),t.TgZ(16,"th",15),t._uU(17,"View Approval"),t.qZA(),t.TgZ(18,"th",15),t._uU(19,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,x,18,11,"tr",16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"div",17),t.TgZ(23,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).showApprovePayments()}),t._UZ(24,"i",19),t._uU(25," Approve"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(21),t.Q6J("ngForOf",e.pendingPaymentList)}}function b(n,a){if(1&n&&(t.TgZ(0,"div",4),t.TgZ(1,"div",5),t.TgZ(2,"span"),t.TgZ(3,"strong"),t.TgZ(4,"label"),t._uU(5,"PENDING PAYMENTS"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"div"),t.YNc(7,y,2,1,"div",11),t.YNc(8,q,26,1,"div",3),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(7),t.Q6J("ngIf",0==e.pendingPaymentList.length),t.xp6(1),t.Q6J("ngIf",0!=e.pendingPaymentList.length)}}function P(n,a){if(1&n&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"number"),t.qZA(),t.qZA()),2&n){const e=a.$implicit,o=a.index;t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(e.approval_id),t.xp6(2),t.Oqu(t.xi3(7,4,e.approval_date,"dd-MM-yyyy")),t.xp6(3),t.Oqu(t.lcZ(10,7,e.pay_now_amount))}}function U(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw().back()}),t._UZ(2,"i",24),t._uU(3," Back"),t.qZA(),t.TgZ(4,"div",4),t.TgZ(5,"div",5),t.TgZ(6,"span"),t.TgZ(7,"strong"),t.TgZ(8,"label"),t._uU(9,"Forward to Bank"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div"),t.TgZ(11,"div"),t.TgZ(12,"div",13),t.TgZ(13,"table",14),t._UZ(14,"caption"),t.TgZ(15,"thead"),t.TgZ(16,"tr"),t.TgZ(17,"th",15),t._uU(18,"SL."),t.qZA(),t.TgZ(19,"th",15),t._uU(20,"Approval ID"),t.qZA(),t.TgZ(21,"th",15),t._uU(22,"Approval Date"),t.qZA(),t.TgZ(23,"th",15),t._uU(24,"Amount"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"tbody"),t.YNc(26,P,11,9,"tr",16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",25),t.TgZ(28,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().back()}),t._UZ(29,"i",24),t._uU(30," Back"),t.qZA(),t.TgZ(31,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().approvePayments()}),t._uU(32,"Forward to bank"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(26),t.Q6J("ngForOf",e.selected_items)}}function C(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw().back()}),t._UZ(2,"i",24),t._uU(3," Back"),t.qZA(),t.TgZ(4,"div",4),t.TgZ(5,"div",5),t.TgZ(6,"span"),t.TgZ(7,"strong"),t.TgZ(8,"label"),t._uU(9,"Vendor Payment Approval"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div"),t._UZ(11,"app-vendor-payment-approval",26),t.TgZ(12,"div",25),t.TgZ(13,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().back()}),t._UZ(14,"i",24),t._uU(15," Back"),t.qZA(),t.TgZ(16,"button",27),t._uU(17,"Print "),t._UZ(18,"i",28),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(11),t.Q6J("selectedApproval",e.selectedApproval)}}const w=[{path:"",component:(()=>{class n{constructor(e,o,p){this.layoutService=e,this.service=o,this.toastr=p,this.dist_id="document",this.showTable=!0,this.paymentInvoice=!1,this.approve=!1,this.loadingData=!1,this.fin_year="",this.pendingPaymentList=[],this.selected_items=[],this.showPendingPayments=()=>(0,Z.mG)(this,void 0,void 0,function*(){this.loadingData=!0;let r=yield this.service.get("/dm/getAllPaymentApprovals?fin_year="+this.fin_year);this.pendingPaymentList=r.filter(s=>s.approval_date=new Date(s.approval_date)),this.loadingData=!1,this.showTable=!0}),this.viewDetails=r=>{this.loadingData=!0,this.selectedApproval=r,this.paymentInvoice=!0,this.showTable=!1,this.loadingData=!1},this.showApprovePayments=()=>{this.totalAmmount=0,this.selected_items=this.pendingPaymentList.filter((r,s)=>{if(r.checkbox)return r}),this.approve=!0,this.showTable=!1},this.approvePayments=()=>(0,Z.mG)(this,void 0,void 0,function*(){this.loadingData=!0,this.approve=!1;try{let r=this.selected_items.map(s=>({approval_id:s.approval_id,pp_id:s.pp_id}));yield this.service.post("/dm/forwardToBank",{approval_ids:r}),this.toastr.success("Successfully forwarded to bank."),window.location.href="/dm/approvePayments",this.loadingData=!1}catch(r){this.toastr.error("Server problem. Please try again."),console.error(r),this.loadingData=!1,this.approve=!0}}),this.back=()=>{this.paymentInvoice=!1,this.showTable=!0,this.approve=!1},this.layoutService.setBreadcrumb("Confirm Pending Payments")}ngOnInit(){}changeFinancialYear(e){this.fin_year=e,this.showPendingPayments()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.P),t.Y36(g.v),t.Y36(u._W))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-approve-payments"]],decls:6,vars:5,consts:[["class","mybox",4,"ngIf"],[1,"loader"],["class","spinner-border text-info",4,"ngIf"],[4,"ngIf"],[1,"mybox"],[1,"mybox-header"],[1,"middle"],[1,"row"],[1,"col-lg-4","col-sm-12","col-xs-12"],[3,"newItemEvent"],[1,"spinner-border","text-info"],["class","no-record",4,"ngIf"],[1,"no-record"],[1,"table-responsive"],["id","itemListTable",1,"table","table-striped","table-bordered","table-hover"],["scope","col"],[4,"ngFor","ngForOf"],[1,"rightSubmit"],[1,"btn","btn-info","btn-sm",3,"click"],["aria-hidden","true",1,"fas","fa-check"],["data-toggle","modal","data-target","#viewDetails",1,"btn","btn-outline-info","round",3,"click"],["aria-hidden","true",1,"fas","fa-bars"],["type","checkbox",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-info","btn-sm","topBack",3,"click"],["aria-hidden","true",1,"fas","fa-arrow-left"],[1,"bottomBack"],[3,"selectedApproval"],["onclick","printElem('approval')",1,"btn","btn-info","btn-sm"],["aria-hidden","true",1,"fas","fa-print"]],template:function(e,o){1&e&&(t.YNc(0,f,10,0,"div",0),t.TgZ(1,"div",1),t.YNc(2,h,1,0,"div",2),t.qZA(),t.YNc(3,b,9,2,"div",0),t.YNc(4,U,33,1,"div",3),t.YNc(5,C,19,1,"div",3)),2&e&&(t.Q6J("ngIf",o.showTable),t.xp6(2),t.Q6J("ngIf",o.loadingData),t.xp6(1),t.Q6J("ngIf",o.showTable),t.xp6(1),t.Q6J("ngIf",o.approve),t.xp6(1),t.Q6J("ngIf",o.paymentInvoice))},directives:[c.O5,A.L,c.sg,l.Wl,l.JJ,l.On,T.P],pipes:[c.uU,c.JJ],styles:[""]}),n})(),resolve:{preData:_.v}}];let k=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[v.Bz.forChild(w)],v.Bz]}),n})();var M=i(4466),J=i(7543);let I=(()=>{class n{constructor(){console.log("Approve Payments Module called")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[c.ez,k,M.m,l.u5,J.b]]}),n})()}}]);