"use strict";(self.webpackChunkangular_application=self.webpackChunkangular_application||[]).push([[8018],{8018:(j,f,a)=>{a.r(f),a.d(f,{AgainstPermitModule:()=>V});var p=a(8583),_=a(665),y=a(5913),A=a(6901),h=a(4762),t=a(639),Z=a(4495),x=a(5620),T=a(9344),P=a(2251),v=a(5638),C=a(1879),D=a(4216),M=a(5652),b=a(4959),k=a(1410);const R=["printMR"];function E(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-normal-card"),t.ynx(1,14),t._uU(2,"ALL PERMITS RECEIVED UNDER FARM MECHANISATION"),t.BQk(),t.ynx(3,15),t.TgZ(4,"div",16),t.TgZ(5,"div",17),t.TgZ(6,"app-financial-year",18),t.NdJ("newItemEvent",function(r){return t.CHM(e),t.oxw().changeFinancialYear(r)}),t.qZA(),t.qZA(),t.TgZ(7,"div",17),t.TgZ(8,"label",19),t._uU(9,"Search Farmer Name:"),t.qZA(),t.TgZ(10,"input",20),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().search_farmer_name=r}),t.qZA(),t.qZA(),t.TgZ(11,"div",17),t.TgZ(12,"label",21),t._uU(13,"Search Permit No.:"),t.qZA(),t.TgZ(14,"input",22),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().search_permit_no=r}),t.qZA(),t.qZA(),t.qZA(),t.BQk(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(10),t.Q6J("ngModel",e.search_farmer_name),t.xp6(4),t.Q6J("ngModel",e.search_permit_no)}}function I(n,o){1&n&&t._UZ(0,"div",23)}function O(n,o){if(1&n&&(t.ynx(0,26),t._uU(1),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.hij("No record found on financial year ",e.fin_year,".")}}function U(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t._UZ(7,"br"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.ALo(17,"number"),t.qZA(),t.TgZ(18,"td",32),t.TgZ(19,"div",16),t.TgZ(20,"div",33),t.TgZ(21,"button",34),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(3).showDetailes(l)}),t._UZ(22,"i",35),t.qZA(),t.qZA(),t.TgZ(23,"div",36),t.TgZ(24,"button",37),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(3).payDetails(l)}),t._uU(25,"Receive"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=o.$implicit,i=o.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.PERMIT_ORDER),t.xp6(2),t.hij("",e.VCHFARMERNAME," "),t.xp6(2),t.hij(" ( ",e.FARMER_ID," ) "),t.xp6(2),t.Oqu(e.Implement),t.xp6(2),t.Oqu(e.Make),t.xp6(2),t.Oqu(e.Model),t.xp6(2),t.Oqu(t.lcZ(17,8,e.FULL_COST))}}function F(n,o){if(1&n){const e=t.EpF();t.ynx(0,15),t.TgZ(1,"table",27),t._UZ(2,"caption"),t.TgZ(3,"thead"),t.TgZ(4,"tr"),t.TgZ(5,"th",28),t._uU(6,"SL."),t.qZA(),t.TgZ(7,"th",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortedOrderOfColumn("PERMIT_ORDER")}),t._uU(8,"Permit no."),t.qZA(),t.TgZ(9,"th",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortedOrderOfColumn("VCHFARMERNAME")}),t._uU(10,"Farmer name(ID)"),t.qZA(),t.TgZ(11,"th",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortedOrderOfColumn("Implement")}),t._uU(12,"Product Category"),t.qZA(),t.TgZ(13,"th",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortedOrderOfColumn("Make")}),t._uU(14,"Manufacturer"),t.qZA(),t.TgZ(15,"th",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortedOrderOfColumn("Model")}),t._uU(16,"Model / Item"),t.qZA(),t.TgZ(17,"th",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortedOrderOfColumn("SUB_AMNT")}),t._uU(18,"Full amount(\u20b9) "),t.qZA(),t.TgZ(19,"th",30),t._uU(20,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"tbody"),t.YNc(22,U,26,10,"tr",31),t.ALo(23,"search"),t.ALo(24,"search"),t.qZA(),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(22),t.Q6J("ngForOf",t.xi3(23,1,t.xi3(24,4,e.allOrders,e.search_permit_no),e.search_farmer_name))}}function N(n,o){if(1&n&&(t.TgZ(0,"app-table-card"),t.ynx(1,14),t._uU(2,"Permit List"),t.BQk(),t.YNc(3,O,2,1,"ng-container",24),t.YNc(4,F,25,7,"ng-container",25),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",0==e.allOrders.length),t.xp6(1),t.Q6J("ngIf",0!=e.allOrders.length)}}function q(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",38),t.NdJ("click",function(){return t.CHM(e),t.oxw().goto2ndPage()}),t._UZ(2,"i",39),t.qZA(),t.TgZ(3,"app-normal-card"),t.ynx(4,14),t._uU(5,"MONEY RECEIPT"),t.BQk(),t.ynx(6,15),t._UZ(7,"app-farmer-money-receipt",40),t.BQk(),t.ynx(8,41),t.TgZ(9,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().goto2ndPage()}),t._UZ(10,"i",39),t._uU(11," Back"),t.qZA(),t.TgZ(12,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().proceedPay()}),t._uU(13,"Confirm & Print"),t.qZA(),t._UZ(14,"button",43,44),t.BQk(),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("data",e.data)("DMDetails",e.DMDetails),t.xp6(7),t.Q6J("useExistingCss",!0)}}function w(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",38),t.NdJ("click",function(){return t.CHM(e),t.oxw().goto1stPage()}),t._UZ(2,"i",39),t.qZA(),t.TgZ(3,"app-table-card"),t.ynx(4,14),t._uU(5,"Permit Details"),t.BQk(),t.ynx(6,15),t._UZ(7,"app-view-permit-details",11),t.BQk(),t.qZA(),t.TgZ(8,"app-normal-card"),t.ynx(9,14),t._uU(10,"Enter Receipt Details"),t.BQk(),t.ynx(11,15),t._UZ(12,"app-enter-receipt-details",45),t.BQk(),t.ynx(13,41),t.TgZ(14,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().goto1stPage()}),t._UZ(15,"i",39),t._uU(16," Back"),t.qZA(),t.TgZ(17,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().showReceipt()}),t._uU(18,"Proceed"),t.qZA(),t.BQk(),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("order",e.order),t.xp6(5),t.Q6J("receiptDetailsForm",e.receiptDetailsForm)}}const J=[{path:"",component:(()=>{class n{constructor(e,i,r,l){this.layoutService=e,this.service=i,this.toastr=r,this.fb=l,this.printPage=!1,this.enterPaymentNo=!1,this.cDate=new Date,this.firstPage=!1,this.header=!0,this.secondPage=!1,this.data={},this.loadingData=!1,this.allOrders=[],this.order={},this.loadAccDetails=()=>(0,h.mG)(this,void 0,void 0,function*(){const s=yield this.service.get("/accountant/getAccName");this.acc_name=s.acc_name}),this.loadOrders=()=>(0,h.mG)(this,void 0,void 0,function*(){this.loadingData=!0,this.firstPage=!1;const s=this.service.directUrlGet("http://mkuy.apicol.nic.in/api/permit?yr="+this.fin_year+"&distcd="+this.dist_id),m=yield this.service.get("/accountant/getAvailableOrders?fin_year="+this.fin_year),g=yield s;this.allOrders=Enumerable.From(g).Except(m,c=>null==c.permit_no?c.PERMIT_ORDER:c.permit_no).ToArray(),this.allOrders.forEach(c=>{const d=c.DT_P_VALIDITY.split("/");c.DT_P_VALIDITY=new Date(d[2],d[1]-1,d[0]);const u=c.DT_PERMIT.split("/");c.DT_PERMIT=new Date(u[2],u[1]-1,u[0])}),this.allOrders.sort((c,d)=>d.DT_PERMIT-c.DT_PERMIT),this.loadingData=!1,this.firstPage=!0}),this.showDetailes=s=>{this.order=s},this.payDetails=s=>(0,h.mG)(this,void 0,void 0,function*(){this.order=s,this.receiptDetailsForm.patchValue({paymentReceived:this.order.FULL_COST}),this.setEmptyAllFields();let m=yield this.service.get("/accountant/getDMDetails");this.DMDetails=m,this.payment_type="DD",this.amount_pay_now=parseFloat(s.FULL_COST),this.goto2ndPage()}),this.showReceipt=()=>{this.amount_pay_now=this.receiptDetailsForm.value.paymentReceived,this.payment_type=this.receiptDetailsForm.value.paymentType,this.payment_no=this.receiptDetailsForm.value.paymentNo,this.payment_date=this.receiptDetailsForm.value.paymentDate,this.source_bank=this.receiptDetailsForm.value.sourceBank,this.other_bank_name=this.receiptDetailsForm.value.otherBankName,this.remark=this.receiptDetailsForm.value.remark,this.amount_pay_now>this.order.FULL_COSTFULL_COST||this.amount_pay_now<1?this.toastr.error("Please enter valid Amount","Invalid amount"):""==this.payment_date?this.toastr.error("Please enter all the required fields first"):("other_bank"==this.source_bank&&(this.source_bank=this.other_bank_name),this.data.date=this.payment_date,this.data.office=this.order.Dist_Name,this.data.farmer_name=this.order.VCHFARMERNAME,this.data.farmer_id=this.order.FARMER_ID,this.data.full_ammount=this.amount_pay_now,this.data.permit_no=this.order.PERMIT_ORDER,this.data.implement=this.order.Implement,this.data.payment_mode=this.payment_type,this.data.payment_date=this.payment_date,this.data.source_bank=this.source_bank,this.data.acc_name=this.acc_name,this.secondPage=!1,this.header=!1,this.printPage=!0,this.firstPage=!1)},this.proceedPay=()=>(0,h.mG)(this,void 0,void 0,function*(){this.loadingData=!0;let s={reference_no:this.order.PERMIT_ORDER,permit_no:this.order.PERMIT_ORDER,payment_type:this.payment_type,amount:this.amount_pay_now,payby:this.userid,farmer_id:this.order.FARMER_ID,dist_id:this.dist_id,payment_no:this.payment_no,remark:this.remark,payment_date:this.payment_date},m=this.order;m.dist_id=this.dist_id,m.fin_year=this.fin_year,m.paid_amount=this.amount_pay_now;let g={receipt_no:this.receipt_no,office:this.order.Dist_Name,farmer_name:this.order.VCHFARMERNAME,farmer_id:this.order.FARMER_ID,full_ammount:this.amount_pay_now,permit_no:this.order.PERMIT_ORDER,implement:this.order.Implement,dist_id:this.dist_id,payment_mode:this.payment_type,source_bank:this.source_bank,payment_no:this.payment_no,payment_date:this.payment_date};try{const c={paymentDetails:s,orderDetails:m,receiptDetails:g},d=yield this.service.post("/accountant/addPaymentOrderReceipt",c);this.receipt_no=d.receiptNo,this.data.receipt_no=d.receiptNo,this.loadingData=!1,console.log(d),setTimeout(()=>{this.printMR.nativeElement.click(),this.printPage=!1}),this.loadOrders(),this.setEmptyAllFields()}catch(c){console.error(c),window.alert("Failed to add receive money. Try again."),this.loadingData=!1}}),this.setEmptyAllFields=()=>{this.amount_pay_now="",this.payment_no="",this.source_bank="",this.remark="",this.payment_type="",this.payment_date="",this.other_bank_name=""},this.goto2ndPage=()=>{this.firstPage=!1,this.header=!1,this.secondPage=!0,this.printPage=!1},this.goto1stPage=()=>{this.header=!0,this.firstPage=!0,this.secondPage=!1,this.printPage=!1},this.back=()=>{this.showData=!0,this.printPage=!1,this.firstPage=!0,this.header=!0},this.sortedOrderOfColumn=s=>{this.orderBy=s},this.layoutService.setBreadcrumb("Money Receipt / Against Permit"),this.dist_id=e.getDistrictID(),this.receiptDetailsForm=this.fb.group({paymentReceived:["",[_.kI.required]],paymentType:["DD",[_.kI.required]],paymentNo:["",[_.kI.required]],paymentDate:["",[_.kI.required]],sourceBank:["",[_.kI.required]],otherBankName:["",[_.kI.required]],remark:["",[_.kI.required]]})}ngOnInit(){}changeFinancialYear(e){this.fin_year=e,this.loadOrders(),this.header=!0}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Z.P),t.Y36(x.v),t.Y36(T._W),t.Y36(_.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-against-permit"]],viewQuery:function(e,i){if(1&e&&t.Gf(R,5),2&e){let r;t.iGM(r=t.CRH())&&(i.printMR=r.first)}},decls:20,vars:6,consts:[[4,"ngIf"],[1,"loader"],["class","spinner-border text-info",4,"ngIf"],[1,"container"],["id","viewDetails",1,"modal","fade"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal",1,"close"],[1,"modal-body",2,"padding","0"],[3,"order"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-outline-danger","round"],[1,"card-head"],[1,"card-body"],[1,"row"],[1,"col-lg-4","col-sm-12","col-xs-12"],[3,"newItemEvent"],["for","searchFarmerName"],["id","searchFarmerName","type","text","placeholder","Enter farmer name",1,"form-control",3,"ngModel","ngModelChange"],["for","searchPermitNo"],["type","text","placeholder","Enter permit no.","id","searchPermitNo",1,"form-control",3,"ngModel","ngModelChange"],[1,"spinner-border","text-info"],["class","no-record",4,"ngIf"],["class","card-body",4,"ngIf"],[1,"no-record"],["id","orderListTable",1,"table","table-striped","table-bordered","table-hover","table-head-fixed"],["scope","col"],["scope","col",3,"click"],["scope","col",2,"text-align","center"],[4,"ngFor","ngForOf"],[2,"width","13%"],[1,"col-md-4"],["data-toggle","modal","data-target","#viewDetails",1,"btn","btn-outline-info","round",3,"click"],["aria-hidden","true",1,"fas","fa-bars"],[1,"col-md-6"],["data-toggle","modal","data-target","#payHere",1,"btn","btn-outline-info","round",3,"click"],[1,"btn","btn-info","btn-sm","topBack",3,"click"],["aria-hidden","true",1,"fas","fa-arrow-left"],["id","printPage",3,"data","DMDetails"],[1,"card-footer"],[1,"btn","btn-info","btn-sm",3,"click"],["hidden","true","printTitle","Money Receipt","printSectionId","printPage","ngxPrint","",3,"useExistingCss"],["printMR",""],[3,"receiptDetailsForm"]],template:function(e,i){1&e&&(t.YNc(0,E,15,2,"app-normal-card",0),t.TgZ(1,"div",1),t.YNc(2,I,1,0,"div",2),t.qZA(),t.YNc(3,N,5,2,"app-table-card",0),t.YNc(4,q,16,3,"ng-container",0),t.TgZ(5,"div",3),t.TgZ(6,"div",4),t.TgZ(7,"div",5),t.TgZ(8,"div",6),t.TgZ(9,"div",7),t.TgZ(10,"h4",8),t._uU(11,"Order details"),t.qZA(),t.TgZ(12,"button",9),t._uU(13,"\xd7"),t.qZA(),t.qZA(),t.TgZ(14,"div",10),t._UZ(15,"app-view-permit-details",11),t.qZA(),t.TgZ(16,"div",12),t.TgZ(17,"button",13),t._uU(18," Close"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(19,w,19,2,"ng-container",0)),2&e&&(t.Q6J("ngIf",i.header),t.xp6(2),t.Q6J("ngIf",i.loadingData),t.xp6(1),t.Q6J("ngIf",i.firstPage),t.xp6(1),t.Q6J("ngIf",i.printPage),t.xp6(11),t.Q6J("order",i.order),t.xp6(4),t.Q6J("ngIf",i.secondPage))},directives:[p.O5,P.a,v.w,C.L,_.Fj,_.JJ,_.On,D.r,p.sg,M.i,y.I,b.b],pipes:[k.G,p.JJ],styles:[""]}),n})()}];let Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[A.Bz.forChild(J)],A.Bz]}),n})();var B=a(3851),H=a(9352),L=a(2582),Y=a(4466),S=a(1238),G=a(9986);let V=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.ez,Q,Y.m,_.u5,y.K,B.$,H.j,L.d,S.D,G.z]]}),n})()}}]);