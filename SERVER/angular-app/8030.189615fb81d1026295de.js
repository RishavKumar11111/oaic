"use strict";(self.webpackChunkangular_application=self.webpackChunkangular_application||[]).push([[8030],{8030:(y,v,d)=>{d.r(v),d.d(v,{PayToVendorModule:()=>j});var p=d(8583),T=d(4466),s=d(665),m=d(5913),Z=d(6901),_=d(4762),t=d(639),q=d(4495),x=d(5620),b=d(1841),P=d(9344),U=d(1879),I=d(231),C=d(1410);function M(o,a){if(1&o&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("ngValue",e),t.xp6(1),t.hij(" ",e.LegalBussinessName," ")}}const h=function(){return{standalone:!0}};function V(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",20),t.TgZ(1,"div",21),t.TgZ(2,"span"),t.TgZ(3,"strong"),t.TgZ(4,"label"),t._uU(5,"Vendor Payment"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"div",4),t.TgZ(7,"div",13),t.TgZ(8,"div",22),t.TgZ(9,"app-financial-year",23),t.NdJ("newItemEvent",function(r){return t.CHM(e),t.oxw().changeFinancialYear(r)}),t.qZA(),t.qZA(),t.TgZ(10,"div",24),t.TgZ(11,"label"),t._uU(12,"Vendors :"),t.qZA(),t.TgZ(13,"select",25),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().dealer=r}),t.TgZ(14,"option",26),t._uU(15,"ALL"),t.qZA(),t.YNc(16,M,2,2,"option",27),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(13),t.Q6J("ngModel",e.dealer)("ngModelOptions",t.DdM(3,h)),t.xp6(3),t.Q6J("ngForOf",e.dealer_list)}}function D(o,a){1&o&&t._UZ(0,"div",29)}function L(o,a){if(1&o&&(t.TgZ(0,"div",31),t._UZ(1,"br"),t._uU(2),t.qZA()),2&o){const e=t.oxw(2);t.xp6(2),t.hij(" No record found on financial year ",e.fin_year,". ")}}function w(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t._UZ(7,"br"),t._uU(8),t._UZ(9,"br"),t._uU(10),t._UZ(11,"br"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t._UZ(16,"br"),t._uU(17),t._UZ(18,"br"),t._uU(19),t.ALo(20,"date"),t.qZA(),t.TgZ(21,"td"),t.TgZ(22,"button",36),t.NdJ("click",function(){const u=t.CHM(e).$implicit;return t.oxw(3).loadList(u)}),t._uU(23,"MRR List "),t._UZ(24,"i",37),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=a.$implicit,i=a.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.LegalBussinessName),t.xp6(2),t.hij(" No.: ",e.PONo," "),t.xp6(2),t.hij(" Type: ",e.POType," "),t.xp6(2),t.hij(" Amount: ",e.POAmount," "),t.xp6(2),t.hij(" Date: ",t.xi3(13,9,e.ApprovedDate,"dd-MM-y")," "),t.xp6(3),t.hij(" No.: ",e.InvoiceNo," "),t.xp6(2),t.hij(" Amount: ",e.InvoiceAmount," "),t.xp6(2),t.hij(" Date: ",t.xi3(20,12,e.InvoiceDate,"dd-MM-y")," ")}}function J(o,a){if(1&o&&(t.TgZ(0,"div"),t.TgZ(1,"div",32),t.TgZ(2,"table",33),t._UZ(3,"caption"),t.TgZ(4,"thead"),t.TgZ(5,"tr"),t.TgZ(6,"th",34),t._uU(7,"SL."),t.qZA(),t.TgZ(8,"th",34),t._uU(9,"Vendor"),t.qZA(),t.TgZ(10,"th",34),t._uU(11,"P.O.Details"),t.qZA(),t.TgZ(12,"th",34),t._uU(13,"Invoice Details"),t.qZA(),t.TgZ(14,"th",34),t._uU(15,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"tbody"),t.YNc(17,w,25,15,"tr",35),t.ALo(18,"search"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(17),t.Q6J("ngForOf",t.xi3(18,1,e.invoice_list,e.dealer.dl_id))}}function N(o,a){if(1&o&&(t.TgZ(0,"div",20),t.TgZ(1,"div",21),t.TgZ(2,"span"),t.TgZ(3,"strong"),t.TgZ(4,"label"),t._uU(5,"All Invoices"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"div"),t.YNc(7,L,3,1,"div",30),t.YNc(8,J,19,4,"div",3),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(7),t.Q6J("ngIf",0==e.invoice_list.length),t.xp6(1),t.Q6J("ngIf",0!=e.invoice_list.length)}}function O(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t._UZ(5,"br"),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t._UZ(10,"br"),t._uU(11),t._UZ(12,"br"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"number"),t.qZA(),t.TgZ(17,"td"),t.TgZ(18,"input",44),t.NdJ("ngModelChange",function(r){return t.CHM(e).$implicit.checkbox=r}),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=a.$implicit,i=a.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.hij(" No.: ",e.MRRNo," "),t.xp6(2),t.hij(" Date: ",t.xi3(7,9,e.InsertedDate,"dd-MM-y")," "),t.xp6(3),t.hij(" Product Category: ",e.Implement," "),t.xp6(2),t.hij(" Manufacturer: ",e.Make," "),t.xp6(2),t.hij(" Model/Item: ",e.Model," "),t.xp6(2),t.hij("\u20b9 ",t.lcZ(16,12,e.TotalInvoiceValue),""),t.xp6(3),t.Q6J("ngModel",e.checkbox)("ngModelOptions",t.DdM(14,h))}}function k(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"button",38),t.NdJ("click",function(){return t.CHM(e),t.oxw().backToInvoice()}),t._UZ(2,"i",39),t._uU(3," Back"),t.qZA(),t.TgZ(4,"div",20),t.TgZ(5,"div",21),t.TgZ(6,"span"),t.TgZ(7,"strong"),t.TgZ(8,"label"),t._uU(9,"All Received Items/Models"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div"),t.TgZ(11,"div",32),t.TgZ(12,"table",40),t._UZ(13,"caption"),t.TgZ(14,"thead"),t.TgZ(15,"tr"),t.TgZ(16,"th",34),t._uU(17,"SL."),t.qZA(),t.TgZ(18,"th",34),t._uU(19,"MRR Details"),t.qZA(),t.TgZ(20,"th",34),t._uU(21,"Goods"),t.qZA(),t.TgZ(22,"th",34),t._uU(23,"Invoice Value(\u20b9)"),t.qZA(),t.TgZ(24,"th",34),t._uU(25,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"tbody"),t.YNc(27,O,19,15,"tr",35),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"div",41),t.TgZ(29,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().backToInvoice()}),t._UZ(30,"i",39),t._uU(31," Back"),t.qZA(),t.TgZ(32,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw().enterPaymentDetail()}),t._uU(33,"Pay"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(27),t.Q6J("ngForOf",e.payList)}}function F(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"button",38),t.NdJ("click",function(){return t.CHM(e),t.oxw().back()}),t._UZ(2,"i",39),t._uU(3," Back"),t.qZA(),t.TgZ(4,"div",20),t.TgZ(5,"div",21),t.TgZ(6,"span"),t.TgZ(7,"strong"),t.TgZ(8,"label"),t._uU(9,"APPROVAL"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div"),t.TgZ(11,"div"),t._UZ(12,"app-vendor-payment-approval",45),t.qZA(),t.TgZ(13,"div",41),t.TgZ(14,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().back()}),t._UZ(15,"i",39),t._uU(16," Back"),t.qZA(),t.TgZ(17,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendApproval()}),t._uU(18,"Send Approval"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(12),t.Q6J("invoice_list",e.invoice_list)("payList",e.payList)}}const S=[{path:"",component:(()=>{class o{constructor(e,i,r,u){this.layoutService=e,this.service=i,this.http=r,this.toastr=u,this.dealer={},this.PayDetailes=!1,this.itemsList=!1,this.show_invoice_list=!0,this.paymentInvoice=!1,this.showPrintIndent=!1,this.loader=!1,this.dealer_list=[],this.invoice_list=[],this.selectedInvoice={},this.approval_id={},this.loadDealers=()=>(0,_.mG)(this,void 0,void 0,function*(){let n=yield this.service.get("/accountant/getAllDistWiseDelear?fin_year="+this.fin_year+"&dist_id="+this.dist_id);this.dealer_list=n}),this.loadInvoiceListByFinYearWise=()=>(0,_.mG)(this,void 0,void 0,function*(){this.loader=!0;const n=yield this.service.get(`/accountant/getFinYearWiseInvoiceList?fin_year=${this.fin_year}`);this.invoice_list=n,this.loader=!1,this.show_invoice_list=!0,this.paymentInvoice=!1}),this.loadList=n=>(0,_.mG)(this,void 0,void 0,function*(){try{this.loader=!0,this.tax_mode=null==n.gst_rate?1:2,this.gst_rate=n.gst_rate,this.invoice_no=n.InvoiceNo,this.selectedVendorID=n.VendorID,this.selectedInvoice=n;const c=yield this.service.get("/accountant/getInvoiceItemsForPay?invoice_no="+this.invoice_no);this.itemsList=!0,this.show_invoice_list=!1,this.payItems=0,this.payList=c,this.payList.forEach(l=>{const g=l.ItemQuantity;l.TotalTaxableValue=l.PurchaseTaxableValue*g,l.TotalCGST=l.PurchaseCGST*g,l.TotalSGST=l.PurchaseSGST*g,l.TotalInvoiceValue=l.PurchaseInvoiceValue*g;const f=l.PurchaseInvoiceValue/(100+l.TaxRate);l.TotalLessCGST=f*g,l.TotalLessSGST=f*g}),this.loader=!1;const A=yield this.service.get("/accountant/getDelearDetails?VendorID="+this.selectedVendorID);this.dl=A}catch(c){console.error(c),window.alert("Unexpected error")}}),this.enterPaymentDetail=()=>(0,_.mG)(this,void 0,void 0,function*(){this.selected_items=this.payList.filter(n=>n.checkbox),this.invoice_items=this.selected_items,this.subTotal=this.selected_items.reduce((n,c)=>n+c.TotalInvoiceValue,0),this.less_cgst=this.selected_items.reduce((n,c)=>n+c.TotalLessCGST,0),this.less_sgst=this.selected_items.reduce((n,c)=>n+c.TotalLessSGST,0),this.pay_now=this.subTotal-this.less_sgst-this.less_cgst,this.paid_amount=0,this.deduction_amount=0,this.apDesc=this.selected_items.map(n=>({permit_no:n.permit_no,mrr_id:n.mrr_id})),this.invoice_date=new Date(this.selectedInvoice.invoice_date),this.indent_date=new Date(this.selectedInvoice.ApprovedDate),this.indent_no=this.selectedInvoice.indent_no,this.invoice_no=this.selectedInvoice.InvoiceNo,this.invoice_amount=this.selectedInvoice.invoice_ammount,this.indent_amount=this.selectedInvoice.POAmount}),this.showDetailesOfPayment=()=>(0,_.mG)(this,void 0,void 0,function*(){this.pay_now=this.pay_now-this.deduction_amount,this.paymentInvoice=!0,this.itemsList=!1}),this.sendApproval=()=>(0,_.mG)(this,void 0,void 0,function*(){try{let n={fin_year:this.fin_year,dist_id:this.dist_id,dl_id:this.selectedVendorID,invoice_no:this.invoice_no,indent_no:this.indent_no,sub_total:this.subTotal,deduction_amount:this.deduction_amount,pay_now:this.pay_now,remark:this.remark},c=!1;this.payItems==this.selected_items.length&&(c=!0);let A=yield this.service.post("/accountant/addPaymentApproval",{approval:n,apDesc:this.apDesc,updateInvoice:c,responseType:"text"});this.approval_id=A.approval_id,this.toastr.success("Payment Details successfully sent to DM for Approval",`Approval Id: ${this.approval_id}`)}catch(n){this.toastr.error("Server Problem! Please try again!!"),console.error(n)}}),this.showIndent=()=>{console.log("indent View")},this.backToInvoice=()=>{this.itemsList=!1,this.show_invoice_list=!0},this.back=()=>{this.remark="",this.deduction_amount=0,this.paymentInvoice=!1,this.itemsList=!0},this.layoutService.setBreadcrumb("Vendor Pay / Pay To Vendor"),this.dist_id=e.getDistrictID()}ngOnInit(){}changeFinancialYear(e){this.fin_year=e,this.loadInvoiceListByFinYearWise(),this.loadDealers()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(q.P),t.Y36(x.v),t.Y36(b.eN),t.Y36(P._W))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-pay-to-vendor"]],decls:61,vars:27,consts:[["class","mybox",4,"ngIf"],[1,"loader"],["class","spinner-border text-info",4,"ngIf"],[4,"ngIf"],[1,"middle"],["id","enterPaymentDetail",1,"modal"],[1,"modal-dialog"],[1,"modal-content",2,"width","600px"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal",1,"close"],[1,"modal-body"],["name","myForm"],[1,"row"],[1,"col-lg-4","col-md-4","col-sm-12","col-xs-12"],[1,"col-lg-8","col-md-8","col-sm-12","col-sm-12"],["type","number","min","0","placeholder","0.00","required","",1,"form-control",3,"ngModel","ngModelOptions","max","ngModelChange"],["cols","30","rows","4","maxlength","500","placeholder","Enter remark within 500 words.","required","",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-info",3,"click"],[1,"mybox"],[1,"mybox-header"],[1,"col-lg-3"],[3,"newItemEvent"],[1,"col-lg-5"],[1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"spinner-border","text-info"],["class","no-record",4,"ngIf"],[1,"no-record"],[1,"table-responsive"],[1,"table","table-striped","table-bordered","table-hover",2,"text-align","left"],["scope","col"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-info","round",3,"click"],[1,"fas","fa-arrow-right"],[1,"btn","btn-info","btn-sm","topBack",3,"click"],["aria-hidden","true",1,"fas","fa-arrow-left"],["id","itemListTable",1,"table","table-striped","table-bordered","table-hover",2,"text-align","left"],[1,"bottomBack"],[1,"btn","btn-info","btn-sm",3,"click"],["data-toggle","modal","data-target","#enterPaymentDetail",1,"btn","btn-info","btn-sm",3,"click"],["type","checkbox","id","chk",1,"form-control","larger",3,"ngModel","ngModelOptions","ngModelChange"],["id","printPage",3,"invoice_list","payList"]],template:function(e,i){1&e&&(t.YNc(0,V,17,4,"div",0),t.TgZ(1,"div",1),t.YNc(2,D,1,0,"div",2),t.qZA(),t.YNc(3,N,9,2,"div",0),t.YNc(4,k,34,1,"div",3),t.YNc(5,F,19,2,"div",3),t.TgZ(6,"div",4),t.TgZ(7,"div",5),t.TgZ(8,"div",6),t.TgZ(9,"div",7),t.TgZ(10,"div",8),t.TgZ(11,"h4",9),t._uU(12,"Payment Detail"),t.qZA(),t.TgZ(13,"button",10),t._uU(14,"\xd7"),t.qZA(),t.qZA(),t.TgZ(15,"div",11),t.TgZ(16,"form",12),t.TgZ(17,"div"),t.TgZ(18,"div",13),t.TgZ(19,"div",14),t._uU(20,"Invoice amount (\u20b9) :"),t.qZA(),t.TgZ(21,"div",15),t._uU(22),t.ALo(23,"number"),t.qZA(),t.qZA(),t.TgZ(24,"div",13),t.TgZ(25,"div",14),t._uU(26,"Initiated amount (\u20b9) :"),t.qZA(),t.TgZ(27,"div",15),t._uU(28),t.ALo(29,"number"),t.qZA(),t.qZA(),t.TgZ(30,"div",13),t.TgZ(31,"div",14),t._uU(32,"Less SGST TDS (\u20b9) :"),t.qZA(),t.TgZ(33,"div",15),t._uU(34),t.ALo(35,"number"),t.qZA(),t.qZA(),t.TgZ(36,"div",13),t.TgZ(37,"div",14),t._uU(38,"Less CGST TDS (\u20b9) : "),t.qZA(),t.TgZ(39,"div",15),t._uU(40),t.ALo(41,"number"),t.qZA(),t.qZA(),t.TgZ(42,"div",13),t.TgZ(43,"div",14),t._uU(44,"Pay now (\u20b9) : "),t.qZA(),t.TgZ(45,"div",15),t._uU(46),t.ALo(47,"number"),t.qZA(),t.qZA(),t.TgZ(48,"div",13),t.TgZ(49,"div",14),t._uU(50,"Deduction amount (\u20b9) :"),t.qZA(),t.TgZ(51,"div",15),t.TgZ(52,"input",16),t.NdJ("ngModelChange",function(u){return i.deduction_amount=u}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(53,"div",13),t.TgZ(54,"div",14),t._uU(55,"Remark :"),t.qZA(),t.TgZ(56,"div",15),t.TgZ(57,"textarea",17),t.NdJ("ngModelChange",function(u){return i.remark=u}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(58,"div",18),t.TgZ(59,"button",19),t.NdJ("click",function(){return i.showDetailesOfPayment()}),t._uU(60,"Proceed"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.Q6J("ngIf",i.show_invoice_list),t.xp6(2),t.Q6J("ngIf",i.loader),t.xp6(1),t.Q6J("ngIf",i.show_invoice_list),t.xp6(1),t.Q6J("ngIf",i.itemsList),t.xp6(1),t.Q6J("ngIf",i.paymentInvoice),t.xp6(17),t.Oqu(t.lcZ(23,15,i.selectedInvoice.InvoiceAmount)),t.xp6(6),t.Oqu(t.lcZ(29,17,i.subTotal)),t.xp6(6),t.Oqu(t.lcZ(35,19,i.less_sgst)),t.xp6(6),t.Oqu(t.lcZ(41,21,i.less_cgst)),t.xp6(6),t.Oqu(t.lcZ(47,23,i.pay_now-i.deduction_amount)),t.xp6(6),t.s9C("max",i.subTotal),t.Q6J("ngModel",i.deduction_amount)("ngModelOptions",t.DdM(25,h)),t.xp6(5),t.Q6J("ngModel",i.remark)("ngModelOptions",t.DdM(26,h)))},directives:[p.O5,s._Y,s.JL,s.F,s.qQ,s.wV,s.Fd,s.Fj,s.Q7,s.JJ,s.On,s.nD,U.L,s.EJ,s.YN,s.Kr,p.sg,s.Wl,I.P],pipes:[p.JJ,C.G,p.uU],styles:[""]}),o})()}];let B=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(S)],Z.Bz]}),o})();var Y=d(7543);let j=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.ez,T.m,s.u5,m.K,B,Y.b]]}),o})()},1410:(y,v,d)=>{d.d(v,{G:()=>T});var p=d(639);let T=(()=>{class s{transform(Z,_){return Z?_?(_=_.toLowerCase(),Z.filter(function(t){return JSON.stringify(t).toLowerCase().includes(_)})):Z:null}}return s.\u0275fac=function(Z){return new(Z||s)},s.\u0275pipe=p.Yjl({name:"search",type:s,pure:!0}),s})()}}]);